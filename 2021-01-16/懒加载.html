<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script type="text/javascript" src="js/mData.js"></script>
		<style type="text/css">
			*{
				padding: 0;
				margin: 0;
				list-style: none;
			}
			ul{
				width: 200px;
				margin: 0 auto;
			}
			li{
				height: 200px;
				margin-bottom: 20px;
				border: 1px solid #000;
			}
			img{
				width: 100%;
				height: 100%;
			}
		</style>
	</head>
	<body style="height: 3000px;">
		<ul>
			<!-- <li><img src="" alt=""></li> -->
		</ul>
		<script type="text/javascript">
			/*
			
				懒加载：
					
					1. getBoundingClientRect() ： 获取标签在可视区的位置
					
					2. 网页加载图片
						给img标签的src属性一共地址，浏览器就会加载图片
						
					3. 在渲染数据时，把地址数据放到标签的其他属性里面存储一下
						
			
					4. 取出标签里面属性的值：
						getAttribute('属性');
							结果 ： 属性值
							
							
					5. 删除标签里面的属性：
							removeAttribute('zdy');
							
					6.  浏览器的滚动条事件：
						window.onscroll
						
					7.  获取浏览器的可视区大小
						window.innerHeight : 获取浏览器的高度
						
						
			*/
		   
		   // var oImg = document.querySelectorAll('img')[0];
		   
		   
		   // document.onclick = function(){
			  //  
			  //  //oImg.src = 'https://s10.mogucdn.com/mlcdn/c45406/191021_10ba435l8ffa822hh22l1467c75d9_135x135.jpg';
		   // }
		   
		   // oImg.onclick = function(){
			  //  
			  
			   // var str = this.getAttribute('zdy');
			   
			   // this.removeAttribute('src');
			   // this.removeAttribute('zdy');

			   
			    // console.log(this.zdy,str);
		  //  }
		  //  
		  //  window.onscroll = function(){
			 // 
			 //   var h = window.innerHeight;
			 //     console.log('我滚了',h)
			 //   
		  //}
		  
		  var list = document.querySelectorAll('ul')[0];
		  var arr = mObjData.s_shop_list.docs;
		  
		  var str = '';
		  for(var i=0;i<arr.length;i++){
			  str += '<li><img _src="'+arr[i].img+'" alt=""></li>';
		  }
		  list.innerHTML = str;
		  
		  
		  // 懒加载图片
		  
		  //获取渲染后的img图片
		  lazy()
		  
		  window.onscroll = function(){
			  lazy()
		  }
		 
		 function lazy(){
			 var oImgs = document.querySelectorAll('ul img');
			 var iH = window.innerHeight;
			 for(var i=0;i<oImgs.length;i++){
			 			  
				  var _top = oImgs[i].getBoundingClientRect().top;
				  
				  if(iH >= _top){
					 
					  var s = oImgs[i].getAttribute('_src');
					  
					  if(s != null){
						  // 给标签的src属性赋值
							oImgs[i].src = s;
							// 删除标签的_src属性
							oImgs[i].removeAttribute('_src');
					  }
					  
					  
					  
					   console.log(_top,oImgs[i],s)
				  }
			 			   
			 }
			 
		 }
		</script>
		
	</body>
</html>
